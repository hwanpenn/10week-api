webpackJsonp([15],{1678:function(e,t,a){"use strict";function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(0),c=a.n(i),s=a(12),u=a.n(s),d=a(36),f=a.n(d),p=a(54),m=a.n(p),h=a(43),b=a(44),w=a(45),g=a(47),y=a(46),v=a(55),E=a(131),k=a(32),C=a(11),T=a(600),N=(a.n(T),a(601)),S=(a.n(N),a(602)),O=a.n(S),M=a(56),x=a.n(M),D=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),_=C.g.Item,j=C.i.Search,R=C.s.Option,A=(C.i.TextArea,C.d.Meta),F=function(e){function t(e){r(this,t);var a=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.params={search:"",pageNo:1,pageSize:10},a.url="",a.getTableData=function(e,t,n){var r={search:e,pageNo:t,pageSize:n};a.setState({current:t}),a.props.getDataTkNews(r)},a.getOtherData=function(e,t,n){var r={pageNo:"1",pageSize:"999"};a.props.getOtherTkNews(r)},a.handleSearch=function(e){a.params.search=e,a.getTableData()},a.handlePageChange=function(e){a.params.pageNo=e,a.getTableData()},a.handleSelect=function(e){a.params.createdAt="all"===e?"":e,a.getTableData()},a.onRowSelect=function(e){a.setState({recordSelect:e})},a.showModifyModal=function(e){a.setState({visibleModify:!0,recordAction:e,_id:e.createdAt._id})},a.showModalCreate=function(){a.setState({visible:!0})},a.handleCancelModify=function(){a.setState({visibleModify:!1})},a.handleCancelCreate=function(){a.setState({visible:!1})},a.handleModify=function(){var e=a.formRefModifyData.props.form;e.validateFields(function(t,n){t||(n.url=a.url,n.id=a.state.recordAction._id,n.content=n.content.toHTML(),a.props.updateDataTkNews(n),e.resetFields(),a.setState({visibleModify:!1}))})},a.handleCreate=function(){var e=a.formRefDataCreate.props.form;e.validateFields(function(t,n){t||(n.url=a.url,n.author=window.sessionStorage.getItem("realName"),n.content=n.content.toHTML(),a.props.createDataTkNews(n),e.resetFields(),a.setState({visible:!1}))})},a.saveFormRefModify=function(e){a.formRefModifyData=e},a.saveFormRefCreate=function(e){a.formRefDataCreate=e},a.deleteConfirm=function(e){var t={id:e._id};a.props.deleteDataTkNews(t)},a.resetConfirm=function(e){var t={id:e._id};a.props.updatePasswordDataTkNews(t)},a.handleCancelNews=function(e){console.log(e),a.setState({visibleNews:!1})},a.showModalNews=function(e){a.props.history.push("/mobile/newspage/"+e._id)},a.showModalListNews=function(e){a.props.history.push("/mobile/newspagelist")},a.handleOkNews=function(e){console.log(e),a.setState({visibleNews:!1})},a.state={checked:[],tableData:[],visible:!1,visibleNews:!1,visibleModify:!1,recordAction:{},recordSelect:{},defaultSelectValue:"",record:"",current:1},a}return o(t,e),D(t,[{key:"componentWillMount",value:function(){this.getTableData("",1,10)}},{key:"render",value:function(){var e=this,t=this,a=this.props.classes,i=[{title:"\b\u65b0\u95fb\u6807\u9898",dataIndex:"name",key:"name",width:"20%",render:function(e){return c.a.createElement(C.p,{content:c.a.createElement("div",{style:{width:270}},c.a.createElement("p",null,e))},c.a.createElement("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block",width:200}},e))}},{title:"\u65b0\u95fb\u4f5c\u8005",dataIndex:"author",key:"author",width:"10%",render:function(e){return c.a.createElement("a",null,"\u5341\u5468\u5c0f\u7f16")}},{title:"\b\u6807\u9898\u56fe",dataIndex:"url",key:"url",width:"15%",render:function(e){return c.a.createElement("img",{style:{height:"20px",marginRight:"0px"},src:e,alt:""})}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"createdAt",key:"createdAt",width:"25%",render:function(e){return c.a.createElement(C.p,{content:c.a.createElement("div",{style:{width:270}},c.a.createElement("p",null,e))},c.a.createElement("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block",width:270}},e))}},{title:"\u64cd\u4f5c",key:"action",width:"20%",render:function(t,a){return c.a.createElement("span",null,c.a.createElement("a",{onClick:function(){return e.showModifyModal(a)}},"\u4fee\u6539"),c.a.createElement(C.f,{type:"vertical"}),c.a.createElement("a",{onClick:function(){return e.showModalNews(a)}},"\u67e5\u770b"),c.a.createElement(C.f,{type:"vertical"}),c.a.createElement("a",{onClick:function(){return e.showModalListNews(a)}},"\u5217\u8868"),c.a.createElement(C.f,{type:"vertical"}),c.a.createElement(C.o,{cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",title:"\u786e\u5b9a\u5220\u9664?",onConfirm:function(){return e.deleteConfirm(a)}},c.a.createElement("a",null,"\u5220\u9664")))}}];void 0!==this.props.tablesTkNews.responseOtherTkNews.rows&&this.props.tablesTkNews.responseOtherTkNews.rows.map(function(e,t){return c.a.createElement(R,{value:e._id},e.name)});var s=C.g.create()(function(e){function a(e){r(this,a);var t=l(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.handleChange=function(e){t.setState({editorState:e})},t.state={editorState:O.a.createEditorState(null)},t}return o(a,e),D(a,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,l=e.onCreate,o=e.form,i=o.getFieldDecorator,s=(c.a.createElement(C.x,{accept:"image/*",showUploadList:!1,customRequest:this.uploadHandler},c.a.createElement("button",{type:"button",className:"control-item button upload-button","data-title":"\u63d2\u5165\u56fe\u7247"},c.a.createElement(C.h,{type:"picture",theme:"filled"}))),{name:"file",action:"/api/upload",headers:{},onChange:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?(console.log(e.file.response),t.url=e.file.response.data.url,C.y.success(e.file.name+" \u4e0a\u4f20\u6210\u529f")):"error"===e.file.status&&C.y.error(e.file.name+" \u4e0a\u4f20\u5931\u8d25.")}});return c.a.createElement(C.m,{width:1300,zIndex:9999,visible:a,title:"\u65b0\u589e",cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",onCancel:r,onOk:l},c.a.createElement(C.g,{layout:"vertical"},c.a.createElement(_,{label:"\u6807\u9898"},i("name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u65b0\u95fb\u6807\u9898!"}]})(c.a.createElement(C.i,n({placeholder:""},"placeholder","\u8bf7\u8f93\u5165\u6807\u9898")))),c.a.createElement(_,{label:"\u6807\u9898\u56fe\u7247"},i("file",{rules:[{required:!1,message:"\u8bf7\u9009\u62e9\u6807\u9898\u56fe\u7247!"}]})(c.a.createElement(C.x,s,c.a.createElement(C.c,null,c.a.createElement(C.h,{type:"upload"})," \u4e0a\u4f20\u56fe\u7247")))),c.a.createElement(_,{label:""},i("content",{rules:[{required:!1,validator:function(e,t,a){t.isEmpty()?a("\u8bf7\u8f93\u5165\u6b63\u6587\u5185\u5bb9"):a()}}]})(c.a.createElement(O.a,{placeholder:"\u8bf7\u8f93\u5165\u6b63\u6587\u5185\u5bb9"})))))}}]),a}(c.a.Component)),u=C.g.create()(function(e){function a(){var e,t,n,o;r(this,a);for(var i=arguments.length,c=Array(i),s=0;s<i;s++)c[s]=arguments[s];return t=n=l(this,(e=a.__proto__||Object.getPrototypeOf(a)).call.apply(e,[this].concat(c))),n.handleChange=function(e){console.log("selected "+e),n.props.form.setFieldsValue({categoryId:e})},n.handleBlur=function(){console.log("blur")},n.handleFocus=function(){console.log("focus")},o=t,l(n,o)}return o(a,e),D(a,[{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){e.props.form.setFieldsValue({content:O.a.createEditorState(t.state.recordAction.content)})},200)}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel,r=e.onCreate,l=e.form,o=l.getFieldDecorator,i={name:"file",action:"/api/upload",headers:{},onChange:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?(console.log(e.file.response),t.url=e.file.response.data.url,C.y.success(e.file.name+" \u4e0a\u4f20\u6210\u529f")):"error"===e.file.status&&C.y.error(e.file.name+" \u4e0a\u4f20\u5931\u8d25.")}};return c.a.createElement(C.m,{width:1300,zIndex:9999,visible:a,title:"\u4fee\u6539",cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",onCancel:n,onOk:r},c.a.createElement(C.g,{layout:"vertical"},c.a.createElement(_,{label:"\u98df\u8c31\b\u540d\u79f0"},o("name",{initialValue:t.state.recordAction.name,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4fee\u6539\u98df\u8c31\b\u540d\u79f0!"}]})(c.a.createElement(C.i,null))),c.a.createElement(_,{label:"\u6807\u9898\u56fe\u7247"},o("file",{rules:[{required:!1,message:"\u8bf7\u9009\u62e9\u6807\u9898\u56fe\u7247!"}]})(c.a.createElement(C.x,i,c.a.createElement(C.c,null,c.a.createElement(C.h,{type:"upload"})," \u4e0a\u4f20\u56fe\u7247")))),c.a.createElement(_,{label:""},o("content",{rules:[{required:!1,validator:function(e,t,a){t.isEmpty()?a("\u8bf7\u8f93\u5165\u6b63\u6587\u5185\u5bb9"):a()}}]})(c.a.createElement(O.a,{placeholder:"\u8bf7\u8f93\u5165\u6b63\u6587\u5185\u5bb9"})))))}}]),a}(c.a.Component));return c.a.createElement(h.a,null,c.a.createElement(b.a,{xs:12},c.a.createElement(C.d,null,c.a.createElement(y.a,{color:"rose",icon:!0},c.a.createElement(f.a,{container:!0,spacing:24},c.a.createElement(f.a,{item:!0,xs:6},c.a.createElement(g.a,{color:"rose"},c.a.createElement(m.a,null)),c.a.createElement("h4",{className:a.cardIconTitle}," ")),c.a.createElement(f.a,{style:{textAlign:"right",marginTop:10},item:!0,xs:6},c.a.createElement(j,{placeholder:"\u540d\u79f0\u641c\u7d22",onSearch:function(t){return e.handleSearch(t)},style:{width:200,borderStyle:"solid",borderWidth:0,paddingRight:10}}),c.a.createElement(C.c,{onClick:this.showModalCreate,style:{height:30,marginRight:10},size:"small"},"\u589e\u52a0")))),c.a.createElement(w.a,null,c.a.createElement(C.v,{onRow:function(t){return{onClick:function(){e.onRowSelect(t)}}},key:"tablesTkNews",pagination:!1,columns:i,dataSource:this.props.tablesTkNews.tableDataTkNews,scroll:{x:600,y:360}}),c.a.createElement(C.l,{locale:x.a},c.a.createElement(C.n,{current:this.state.current,showTotal:function(e){return"\u603b\u5171 "+e+" \u6761"},showSizeChanger:!0,showQuickJumper:!0,defaultPageSize:10,total:this.props.tablesTkNews.tableCountTkNews,style:{textAlign:"right",marginTop:25},onShowSizeChange:function(t,a){return e.getTableData("",t,a)},onChange:function(t,a){return e.getTableData("",t,a)}}))))),c.a.createElement(s,{wrappedComponentRef:this.saveFormRefCreate,visible:this.state.visible,onCancel:this.handleCancelCreate,onCreate:this.handleCreate}),c.a.createElement(u,{wrappedComponentRef:this.saveFormRefModify,visible:this.state.visibleModify,onCancel:this.handleCancelModify,onCreate:this.handleModify}),c.a.createElement(C.m,{title:"\u56fe\u7247\u8be6\u60c5",visible:this.state.visibleNews,onCancel:this.handleCancelNews,footer:null},c.a.createElement(C.d,{hoverable:!0,style:{width:472},cover:c.a.createElement("img",{alt:"\u98df\u8c31\b\u56fe\u7247",src:t.state.record.url})},c.a.createElement(A,{title:t.state.record.name,description:t.state.record.extra}))))}}]),t}(c.a.Component),P=function(e){return{tablesTkNews:e.tablesTkNews}},I=function(e){return{getDataTkNews:function(t){e(Object(E.h)(t))},updateDataTkNews:function(t){e(Object(E.j)(t))},deleteDataTkNews:function(t){e(Object(E.g)(t))},createDataTkNews:function(t){e(Object(E.f)(t))},getOtherTkNews:function(t){e(Object(E.i)(t))},updatePasswordDataTkNews:function(t){e(Object(E.k)(t))}}};t.default=Object(k.b)(P,I)(u()(v.a)(F))}});
//# sourceMappingURL=tablesTkNews.ab5b7a85.chunk.js.map